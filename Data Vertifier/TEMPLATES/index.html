<!DOCTYPE html>
<html>
<head>
<title>Welcome to CDP Helper</title>
 <style>
    a
    {
        margin-top:15px;
        display:block
    }
 </style>
	<script src="../static/jquery-1.11.1.min.js" type="text/javascript"></script>
</head>
<body>

<div style="padding:20px 50px;float:left">


	<script type="text/javascript">
		$$.ajaxSetup({cache:false});

       function get_full_increment_mode(){
		    var u = '/getfimode/'
		    $$.get(u, function(rs){
		    	//alert(rs)
				$$('#full_increment').html(rs)
			})
		}

		function getsyncstatus(){
			var u = '/getjobstatus/'

			$$.getJSON(u, function(rs){
				var s = 'Sync Job Information:<br />'
				for(var key in rs[0]){
					var v = ''
					if (rs[0][key].indexOf('Canceled')!=-1){
						v = '<font color=\'red\'>'+rs[0][key]+'</font>'
					}else if(rs[0][key].indexOf('Fail')!=-1){
						v = '<font color=\'red\'>'+rs[0][key]+'</font>'
					}else{
						v=rs[0][key]
					}
					s += "<div>" + key + " : " + v + "</div>"
				}
				s = s + '<br />T4 Job Information:<br />'
				for(var key in rs[1]){
					var v = ''
					if (rs[1][key].indexOf('Canceled')!=-1){
						v = '<font color=\'red\'>'+rs[1][key]+'</font>'
					}else if(rs[1][key].indexOf('Fail')!=-1){
						v = '<font color=\'red\'>'+rs[1][key]+'</font>'
					}else if(rs[1][key].indexOf('Run')!=-1){
						v = '<font color=\'red\'>'+rs[1][key]+'</font>'
					}else{
						v=rs[1][key]
					}
					s += "<div>" + key + " : " + v + "</div>"
				}
				$$('#jobstatus').html(s)
			})
		}

		//function switchdb(){
		//	var d = $$('#dbsel').val()
		//	var u = '/switchdb/'
		//	$$.post(u, {'db':d}, function(rs){
		//		alert(rs)
		//	})
		//	get_full_increment_mode()
		//}
	</script>


    <a href="/execlog/" target="view_window">Mdx KPI Browse Logs</a>

    <a href="/mdxquery/" target="view_window">Generate MDX Query</a>

    <a href="/dim/" target="view_window">Dim ID List</a>

    <a href="/verifykpi/T4" target="view_window">T4 Premier&amp;BC Verify KPI Values</a>

    <a href="/verifykpi/DE" target="view_window">DeliveryExcellence Verify KPI Values</a>

	<a href="/addnode/" target="view_window">Add New Hierarchy Node</a>

	<a href="/clipboard/" target="view_window">Clipboard</a>

	<a href="/batchexec/" target="view_window">Run SQL script to Multi-Server</a>

	<a href="/backupsql/" target="view_window">Show Backup Sql Script</a>
</div>

<div style="float:left;padding:18px 0px 0px 250px;">
	<h2>Status:</h2>
	<div id="full_increment" style="margin-top:15px;margin-right:5px;display:inline;font-size:large">Loading......</div>
	<!--<input type="button" value="Refresh" onclick="get_full_increment_mode()" style="display:none" />-->
	<div id="jobstatus" style="margin-top:15px;font-size:large"></div>
</div>

<script type="text/javascript">
	get_full_increment_mode();
	getsyncstatus();
</script>

</body>
</html>